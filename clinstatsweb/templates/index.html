{% extends "base.html" %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div id="percentDups"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div id="readsVsCoverage"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    {{ super() }}

    <script type="text/javascript" charset="utf-8" async defer>
        $(function() {
            $("#percentDups").highcharts({
                chart: {
                    type: "spline"
                },
                title: {
                    text: "Percent duplicates"
                },
                yAxis: {
                    title: {
                        text: "Duplicates (%)"
                    }
                },
                plotOptions: {
                    spline: {
                        marker: {
                            enabled: true
                        },
                        tooltip: {
                            headerFormat: '{series.name}: <b>{point.key}</b><br>',
                            pointFormat: '{point.y} %'
                        }
                    }
                },
                series: [{
                    name: "WGS",
                    color: 'rgba(223, 83, 83, .5)',
                    data: {{ dups.wgs|tojson|safe }}
                }, {
                    name: "WES",
                    color: 'rgba(119, 152, 191, .5)',
                    data: {{ dups.wes|tojson|safe }}
                }]
            })

            $("#readsVsCoverage").highcharts({
                chart: {
                    type: 'scatter',
                    zoomType: 'xy'
                },
                title: {
                    text: 'Reads vs. Target coverage'
                },
                xAxis: {
                    title: {
                        text: 'Total reads'
                    }
                },
                yAxis: {
                    title: {
                        text: 'Target coverage'
                    }
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'bottom',
                    x: -70,
                    y: -70,
                    floating: true,
                    backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF',
                    borderWidth: 1
                },
                plotOptions: {
                    scatter: {
                        marker: {
                            radius: 5
                        },
                        tooltip: {
                            headerFormat: '<b>{series.name}</b><br>',
                            pointFormat: '{point.x} reads, {point.y} %'
                        }
                    }
                },
                series: [{
                    name: 'WGS',
                    color: 'rgba(223, 83, 83, .5)',
                    data: {{ readsvscov.wgs|tojson|safe }}
                }, {
                    name: 'WES',
                    color: 'rgba(119, 152, 191, .5)',
                    data: {{ readsvscov.wes|tojson|safe }}
                }]
            })
        })
    </script>
{% endblock %}
